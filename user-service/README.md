# Microservices Project with Nest.js

This is a microservices project built using **Nest.js**. It consists of the following services:

- **API Gateway**: Central entry point for all client requests. Routes requests to the appropriate microservice.
- **Auth Service**: Handles user authentication (login, JWT management).
- **User Service**: Manages user profiles and related data.

Communication between the services is handled by **RabbitMQ** as a message broker.

## Table of Contents

- [Project Structure](#project-structure)
- [Technologies Used](#technologies-used)
- [Getting Started](#getting-started)
- [Setting Up Services](#setting-up-services)
  - [API Gateway](#api-gateway)
  - [Auth Service](#auth-service)
  - [User Service](#user-service)
- [RabbitMQ Setup](#rabbitmq-setup)
- [Running the Services](#running-the-services)
- [Testing the API](#testing-the-api)
- [Future Enhancements](#future-enhancements)

---

## Project Structure

```
/microservices-project
│
├── /api-gateway
│   ├── src/
│   └── ...
│   └── package.json
│
├── /auth-service
│   ├── src/
│   └── ...
│   └── package.json
│
├── /user-service
│   ├── src/
│   └── ...
│   └── package.json
│
└── docker-compose.yml
```

- **API Gateway**: Acts as a gateway for routing client requests to the respective microservice.
- **Auth Service**: Handles user authentication (login, password, etc.).
- **User Service**: Manages user profile information.

---

## Technologies Used

- **Nest.js**: Node.js framework used for all services.
- **RabbitMQ**: Message broker for communication between services.
- **Docker**: For running RabbitMQ.
- **TypeScript**: The programming language used for the services.

---

## Getting Started

### Prerequisites

Make sure you have the following installed on your local machine:

- **Node.js**: [Download Node.js](https://nodejs.org)
- **Nest.js CLI**: Install globally with:
  ```bash
  npm install -g @nestjs/cli
  ```
- **Docker**: [Download Docker](https://www.docker.com/get-started) (for running RabbitMQ)

---

## Setting Up Services

### 1. API Gateway

The **API Gateway** routes requests to the appropriate service and handles communication between the **Auth** and **User** services.

- Navigate to the `api-gateway` folder:
  ```bash
  cd api-gateway
  ```
- Install the dependencies:
  ```bash
  npm install
  ```

### 2. Auth Service

The **Auth Service** handles user login and returns a JWT token for authentication.

- Navigate to the `auth-service` folder:
  ```bash
  cd auth-service
  ```
- Install the dependencies:
  ```bash
  npm install
  ```

### 3. User Service

The **User Service** manages user profile data and responds to profile-related requests.

- Navigate to the `user-service` folder:
  ```bash
  cd user-service
  ```
- Install the dependencies:
  ```bash
  npm install
  ```

---

## RabbitMQ Setup

The services communicate via **RabbitMQ**, which acts as a message broker. You can run RabbitMQ easily using **Docker**.

### Step 1: Running RabbitMQ

Start RabbitMQ with Docker using the provided `docker-compose.yml` file:

```bash
docker-compose up -d
```

This will expose the RabbitMQ server at `amqp://localhost:5672` and a management UI at `http://localhost:15672` (default login: guest/guest).

---

## Running the Services

### 1. Run the API Gateway

Navigate to the `api-gateway` directory and start the service:

```bash
cd api-gateway
npm run start
```

The API Gateway will run on `http://localhost:3000`.

### 2. Run the Auth Service

Navigate to the `auth-service` directory and start the service:

```bash
cd auth-service
npm run start
```

### 3. Run the User Service

Navigate to the `user-service` directory and start the service:

```bash
cd user-service
npm run start
```

---

## Testing the API

You can test the microservices through the **API Gateway** using **curl** or **Postman**.

### 1. Login via Auth Service (through API Gateway)

```bash
curl -X POST http://localhost:3000/api/login -H "Content-Type: application/json" -d '{"userId": 1, "password": "secret"}'
```

This request will route through the **API Gateway** and be processed by the **Auth Service**, returning a mock JWT token.

### 2. Fetch User Profile (through API Gateway)

```bash
curl -X GET http://localhost:3000/api/profile -H "Content-Type: application/json" -d '{"userId": 1}'
```

This request will route through the **API Gateway** and be processed by the **User Service**, returning a mock user profile.

---

## Future Enhancements

- **Add JWT Authentication**: Secure the routes using JWT tokens generated by the **Auth Service**.
- **Database Integration**: Connect the **User Service** to a PostgreSQL database for persistent user profiles.
- **Rate Limiting and Caching**: Implement rate limiting and response caching in the **API Gateway**.
- **Load Balancing**: Deploy multiple instances of each service for load balancing and scalability.

---

### License

This project is open-source and available under the MIT License.

---

### Authors

- **Asad Anik**
- **Yeaseen Armaan**

---

This `README.md` provides a step-by-step guide to running and testing the microservices project.